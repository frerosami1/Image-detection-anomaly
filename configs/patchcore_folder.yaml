# PatchCore on Folder dataset (edit `dataset.path` to your dataset)

model:
  name: patchcore
  backbone: wide_resnet50_2
  pre_trained: true
  layers:
    - layer2
    - layer3
    - layer4
  coreset_sampling_ratio: 0.1
  coreset_sampling_ratio: 0.2
  num_neighbors: 15

# Folder-style dataset; place images under train/normal, test/normal, test/abnormal
dataset:
  name: MVTecAD
  format: folder
  path: ./datasets/MVTecAD/bottle  # Change bottle to: cable, capsule, etc.
  normal_dir: normal
  abnormal_dir: abnormal
  task: segmentation  # or classification
  image_size: [256, 256]
  center_crop: null
  normalization: imagenet
  train_batch_size: 16
  eval_batch_size: 16
  num_workers: 4

metrics:
  image:
    - AUROC
    - F1Score
  pixel:
    - AUROC
    - F1Score
  threshold:
    method: adaptive

trainer:
  enable_checkpointing: true
  default_root_dir: ./experiments/patchcore_folder
  gpus: 1
  max_epochs: 1
  val_check_interval: 1.0
  check_val_every_n_epoch: 1
  log_every_n_steps: 50

optimization:
  export_mode: torch

logging:
  logger:
    - tensorboard
  log_graph: false

project:
  seed: 42
  path: ./logs
